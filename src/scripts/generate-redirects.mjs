// Generates the Netlify _redirects file from the moved files in the Git history.

import fs from 'fs/promises'

import getMovedPagesFromHistory from './getMovedPagesFromHistory.js'

const movedPages = await getMovedPagesFromHistory()

const lines =
    '\n' +
    '# Generated by generate-redirects.mjs from Git history\n' +
    movedPages.map(({ source, destination }) => `${source} ${destination}`).join('\n') +
    '\n'

await fs.writeFile(new URL('../../_redirects', import.meta.url), lines)
